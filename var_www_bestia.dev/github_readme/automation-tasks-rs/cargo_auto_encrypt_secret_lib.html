<!DOCTYPE html>
<html>

<head>
    <title>cargo_auto_encrypt_secret_lib</title>
    <meta http-equiv="Content-type" content="text/html;charset=utf-8" />
    <meta name="Description" content="OBSOLETE: Library to encrypt/decrypt secrets">
    <meta name="author" content="https://github.com/bestia-dev">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/bestia01.css">
</head>

<body>
    <header>
        <nav>
            <a href="https://bestia.dev/index.html">bestia.dev</a>
        </nav>
    </header>
    <div>&nbsp;</div> 
    <div class="small"><a id="navbar_brand" href="https://bestia.dev" style="justify-content: center;">
                <img src="https://bestia.dev/images/bestia_icon.png" alt="bestia.dev" title="bestia.dev" />
            </a>This is a copy of the Github readme. Find the original on <a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib">https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib</a></div>

<article class="markdown-body entry-content container-lg" itemprop="text">
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">cargo_auto_encrypt_secret_lib</h1><a id="user-content-cargo_auto_encrypt_secret_lib" class="anchor" aria-label="Permalink: cargo_auto_encrypt_secret_lib" href="#cargo_auto_encrypt_secret_lib"></a></div>
<p dir="auto"><strong>OBSOLETE: Library to encrypt/decrypt secrets</strong><br>
<em><strong>version: 1.1.8 date: 2024-04-23 author: <a href="https://bestia.dev" rel="nofollow">bestia.dev</a> repository: <a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib">GitHub</a></strong></em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/593a9f40d5eabd4ee4fa14383030c300c3eabb3dba8ca227ed470c328a850e6a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f727573742d6f72616e6765"><img src="https://img.shields.io/badge/rust-orange" alt="rust" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3cd93794c5945575f0ec11b7350f577451a7e856724331e0699d49aa8629fe97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6f62736f6c6574652d726564"><img src="https://img.shields.io/badge/obsolete-red" alt="obsolete" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/automation-tasks-rs/cargo-auto/main/images/logo/logo_cargo_auto.svg"><img src="https://raw.githubusercontent.com/automation-tasks-rs/cargo-auto/main/images/logo/logo_cargo_auto.svg" alt="logo" style="max-width: 100%;"></a>
this repo is part of the <a href="https://github.com/automation-tasks-rs">automation_tasks_rs</a> project</p>
<p dir="auto"><a href="https://crates.io/crates/cargo_auto_encrypt_secret_lib" rel="nofollow"><img src="https://img.shields.io/crates/v/cargo_auto_encrypt_secret_lib.svg" alt="crates.io" style="max-width: 100%;"></a>
<a href="https://docs.rs/cargo_auto_encrypt_secret_lib/" rel="nofollow"><img src="https://docs.rs/cargo_auto_encrypt_secret_lib/badge.svg" alt="Documentation" style="max-width: 100%;"></a>
<a href="https://lib.rs/crates/cargo_auto_encrypt_secret_lib/" rel="nofollow"><img src="https://img.shields.io/badge/Lib.rs-rust-orange.svg" alt="Lib.rs" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/workflows/rust_fmt_auto_build_test/badge.svg" alt="Rust" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/ce42b7ea4973d562a5a70c87e1d5a479d1eab2c00aab32a42697a244368c095a/68747470733a2f2f6265737469612e6465762f776562706167655f6869745f636f756e7465722f6765745f7376675f696d6167652f313738353135343333372e737667"><img src="https://bestia.dev/webpage_hit_counter/get_svg_image/1785154337.svg" alt="Hits" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://img.shields.io/badge/Lines_in_Rust-151-green.svg" alt="Lines in Rust code" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://img.shields.io/badge/Lines_in_Doc_comments-186-blue.svg" alt="Lines in Doc comments" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://img.shields.io/badge/Lines_in_comments-17-purple.svg" alt="Lines in Comments" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://img.shields.io/badge/Lines_in_examples-0-yellow.svg" alt="Lines in examples" style="max-width: 100%;"></a>
<a href="https://github.com/automation-tasks-rs/cargo_auto_encrypt_secret_lib/"><img src="https://img.shields.io/badge/Lines_in_tests-1-orange.svg" alt="Lines in tests" style="max-width: 100%;"></a></p>
<p dir="auto">Hashtags: #rustlang
My projects on GitHub are more like a tutorial than a finished product: <a href="https://github.com/bestia-dev/tutorials_rust_wasm">bestia-dev tutorials</a>.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">OBSOLETE</h2><a id="user-content-obsolete" class="anchor" aria-label="Permalink: OBSOLETE" href="#obsolete"></a></div>
<p dir="auto">This will not be a separate crate anymore. This will be a module file that the developer copy-paste into his source code.
I decided that the developer must have complete control over this code in its own project.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Secrets</h2><a id="user-content-secrets" class="anchor" aria-label="Permalink: Secrets" href="#secrets"></a></div>
<p dir="auto">When we write an application, every connection to any server needs to work with secrets: passwords, passkeys, passcodes, passphrases, API secret_tokens and more.</p>
<p dir="auto">Sometimes it is just fine to let the user type the password. Passwords are easy for humans to remember and type. But they are the least secure.</p>
<p dir="auto">It is much better to have a long random "key" string like the API secret_token, but no human is capable of remembering that. It means we need to store it somewhere.</p>
<p dir="auto">It is theoretically impossible to store this secret 100% securely using only software. Modern computers use special chips for that. But we can make it hard and not obvious for an attacker to get the secret.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">GitHub API secret_token</h2><a id="user-content-github-api-secret_token" class="anchor" aria-label="Permalink: GitHub API secret_token" href="#github-api-secret_token"></a></div>
<p dir="auto">The GitHub API secret_token is a secret just like a password. Maybe even greater.<br>
With this API secret_token, a maleficent actor can change basically anything in your GitHub account. You don't want that.</p>
<p dir="auto">How to protect this secret?<br>
Ok, there are some basic recommendations:</p>
<ul dir="auto">
<li>Give the least permission/authorization to the API secret_token to minimize the harm an attacker can do</li>
<li>Expire the secret_token frequently, so old secret_tokens are of no use</li>
<li>HTTPS is a no-brainer. Never use HTTP ever again. It is plain text over the wire.</li>
<li>Never store the secret_token in a file as plain text</li>
<li>Plain text inside env vars can also be accessed from malware</li>
</ul>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Symmetric encryption</h2><a id="user-content-symmetric-encryption" class="anchor" aria-label="Permalink: Symmetric encryption" href="#symmetric-encryption"></a></div>
<p dir="auto">We will use encryption <a href="https://docs.rs/aes-gcm/latest/aes_gcm/index.html" rel="nofollow">aes_gcm::Aes256Gcm</a> for very short strings like API secret_tokens. So I suppose the performance is not a problem.<br>
We use a passcode of 32 bytes to encrypt a string.<br>
We can also enter a string password, that will be internally hashed into a 32-byte passcode.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Use SSH key to encrypt secret_token</h2><a id="user-content-use-ssh-key-to-encrypt-secret_token" class="anchor" aria-label="Permalink: Use SSH key to encrypt secret_token" href="#use-ssh-key-to-encrypt-secret_token"></a></div>
<p dir="auto">We are accustomed to working with SSH keys because of Git and SSH connection to the web servers.<br>
We already know how to create, secure and manage SSH keys. We know all about the private and public keys.<br>
We know that the private key is secured by a passphrase.<br>
We already know how to add an SSH key to ssh-agent. And we know that the use of ssh-agent makes life easier, but it has some security concerns. In most cases, this is not critical, but you have to choose your own balance between Convenience and Security.<br>
All this knowledge is already mastered because of the workflow when developing in Rust.<br>
We could use the same technique to encrypt the API secret_token.</p>
<p dir="auto">We will use the private key to sign a random seed and the result will be a new super-secret passcode.
The only way to get to this super-secret passcode is to sign the seed with the private key. We suppose that only the owner can sign with his/her private key. This is the basis of SSH key security.</p>
<p dir="auto">The super-secret passcode will be used to symmetrically encrypt the secret_token and write it to a file as text. It is much simpler to work with text files.</p>
<p dir="auto">Never commit secrets to your repository. GitHub is regularly scanned for uploaded secrets. That is a big no-no. I prefer to store the encrypted secret_token in the <code>~/.ssh</code> directory near to other secret and encrypted keys.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Create an SSH key</h2><a id="user-content-create-an-ssh-key" class="anchor" aria-label="Permalink: Create an SSH key" href="#create-an-ssh-key"></a></div>
<p dir="auto">It is recommended to encrypt every API secret_token with its dedicated SSH key. This way you have granular control over how to use it.</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ssh-keygen -t ed25519 -C &quot;github api secret_token&quot;
# for test type these interactively:
# file name: tests/test_github_api_secret_token_ssh_1
# passphrase: test_passphrase
# repeat passphrase: test_passphrase"><pre>ssh-keygen -t ed25519 -C <span class="pl-s"><span class="pl-pds">"</span>github api secret_token<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">#</span> for test type these interactively:</span>
<span class="pl-c"><span class="pl-c">#</span> file name: tests/test_github_api_secret_token_ssh_1</span>
<span class="pl-c"><span class="pl-c">#</span> passphrase: test_passphrase</span>
<span class="pl-c"><span class="pl-c">#</span> repeat passphrase: test_passphrase</span></pre></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Balance between Convenience and Security</h2><a id="user-content-balance-between-convenience-and-security" class="anchor" aria-label="Permalink: Balance between Convenience and Security" href="#balance-between-convenience-and-security"></a></div>
<p dir="auto">First thing first: it is theoretically impossible to secure a secret 100% only with software. If an attacker gets privileged or physical access to the computer, he can do anything. But that does not mean it is easy and quick. We can make it harder and harder to find a secret. Finally, we have to choose a balance between Convenience and Security.</p>
<p dir="auto">You can choose to type the API key into the terminal every time. This is very inconvenient. You cannot remember the API key, you have to store it somewhere on the computer. And then use copy-paste. This is also a security concern. This secret_token will stay in the clipboard and that is easy to extract.</p>
<p dir="auto">Never store secret_tokens in plain text. Nor in files nor environment variables. Files and env var are easy to upload to a malicious website. Use some kind of secret manager or encryption.</p>
<p dir="auto">When the secret_token is encrypted with SSH, it must be decrypted using the private key. The private key is secured with a passphrase. This passphrase is easy to remember and type. You can choose to type the passphrase on every use of the secret_token. This is pretty secure but inconvenient.</p>
<p dir="auto">Ultimately you can use ssh-agent to decrypt the private key only once typing the passphrase. It will work in the background for a specific time like 1 hour or until the end of the terminal session. This is not secure, because an attacker could use the same open-source code to extract the secret_token from ssh-agent in unencrypted form. But it is tricky to do and it is time-limited.</p>
<p dir="auto">Just to mention the secret_token could be extracted from memory while in use. Or that the attacker could install a key logger and send all typed passwords and passphrases to a malicious website. There are really no limits to software exploits once the attacker has enough privilege.</p>
<p dir="auto">Finally, your choice.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Open-source and free as a beer</h2><a id="user-content-open-source-and-free-as-a-beer" class="anchor" aria-label="Permalink: Open-source and free as a beer" href="#open-source-and-free-as-a-beer"></a></div>
<p dir="auto">My open-source projects are free as a beer (MIT license).<br>
I just love programming.<br>
But I need also to drink. If you find my projects and tutorials helpful, please buy me a beer by donating to my <a href="https://paypal.me/LucianoBestia" rel="nofollow">PayPal</a>.<br>
You know the price of a beer in your local bar ;-)<br>
So I can drink a free beer for your health :-)<br>
<a href="https://translate.google.com/?hl=en&amp;sl=sl&amp;tl=en&amp;text=Na%20zdravje&amp;op=translate" rel="nofollow">Na zdravje!</a> <a href="https://dictionary.cambridge.org/dictionary/italian-english/alla-salute" rel="nofollow">Alla salute!</a> <a href="https://dictionary.cambridge.org/dictionary/german-english/prost" rel="nofollow">Prost!</a> <a href="https://matadornetwork.com/nights/how-to-say-cheers-in-50-languages/" rel="nofollow">Nazdravlje!</a> üçª</p>
<p dir="auto"><a href="https://bestia.dev" rel="nofollow">//bestia.dev</a><br>
<a href="https://github.com/bestia-dev">//github.com/bestia-dev</a><br>
<a href="https://bestiadev.substack.com" rel="nofollow">//bestiadev.substack.com</a><br>
<a href="https://youtube.com/@bestia-dev-tutorials" rel="nofollow">//youtube.com/@bestia-dev-tutorials</a></p>
</article>
</body>

</html>