<!DOCTYPE html>
<html>

<head>
    <title>mem2_server</title>
    <meta http-equiv="Content-type" content="text/html;charset=utf-8" />
    <meta name="Description" content="Learning to code Rust for a http + WebSocket server on the same port">
    <meta name="author" content="https://github.com/bestia-dev">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/bestia01.css">
    <script>
        /* Toggle between adding and removing the "responsive" class to navbar when the user clicks on the hamburger */
        function toggle_responsive_navbar() {
            var x = document.getElementById("navbar");
            if (x.className.includes(" responsive")) {
                x.className = x.className.replace(" responsive", "");
            } else {
                x.className += " responsive";
            }
        }
    </script>
</head>

<body>
    <div class="fixed_header">
        <div id="navbar">
            <a id="navbar_brand" href="https://bestia.dev">
                <img src="bestia_icon.png" alt="Bestia development" title="bestia.dev" />
                <span id="navbar_title"> Bestia dev</span>
            </a>
            <a id="navbar_hamburger" href="javascript:void(0);" onclick="toggle_responsive_navbar()">‚ò∞ </a>
            <div id="navbar_topics">
                <a href="/index.html#home" onclick="toggle_responsive_navbar()">Home </a>
                <a href="/index.html#tutorials" onclick="toggle_responsive_navbar()">Tutorials</a>
                <a href="/index.html#games" onclick="toggle_responsive_navbar()">Games</a>
                <a href="/index.html#productivity" onclick="toggle_responsive_navbar()">Productivity</a>
                <a href="/index.html#contact" onclick="toggle_responsive_navbar()">Contact</a>
            </div>
        </div>
    </div>
    <div>&nbsp;</div> 
    <div class="small">This is a copy of the Github readme.<br/>
    Find the original on <a href="https://github.com/bestia-dev-archived/mem2_server">https://github.com/bestia-dev-archived/mem2_server</a></div>

<article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto">mem2_server</h1><a id="user-content-mem2_server" class="anchor" aria-label="Permalink: mem2_server" href="#mem2_server"></a></div>
<p dir="auto"><strong>Learning to code Rust for a http + WebSocket server on the same port</strong><br>
<em><strong>version: 2.0  date: 2019-04-16 author: <a href="https://bestia.dev" rel="nofollow">bestia.dev</a> repository: <a href="https://github.com/bestia-dev/mem2_server">GitHub</a></strong></em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3cd93794c5945575f0ec11b7350f577451a7e856724331e0699d49aa8629fe97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6f62736f6c6574652d726564"><img src="https://img.shields.io/badge/obsolete-red" alt="status" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/e54b9fd42d0af004535a982c48a2dc4a5c8c2eebc8fe49426eb3f69fdddf2c36/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f61726368697665642d726564"><img src="https://img.shields.io/badge/archived-red" alt="status" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/c273959e453b2eacb9b7719663be397499b129c79eb13180305a069b3c2f5e51/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f7475746f7269616c2d79656c6c6f77"><img src="https://img.shields.io/badge/tutorial-yellow" alt="status" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6481763e52042b5e8dcc22410a1bc2e67fa4c8bdb0dd1f4784b4e37152c72905/68747470733a2f2f6265737469612e6465762f776562706167655f6869745f636f756e7465722f6765745f7376675f696d6167652f3731373738383333342e737667"><img src="https://bestia.dev/webpage_hit_counter/get_svg_image/717788334.svg" alt="Hits" style="max-width: 100%;"></a></p>
<p dir="auto">Hashtags: #rustlang #game #tutorial<br>
My projects on Github are more like a tutorial than a finished product: <a href="https://github.com/bestia-dev/tutorials_rust_wasm">bestia-dev tutorials</a>.</p>
<p dir="auto">using Warp for a simple memory game for kids - mem2.</p>
<p dir="auto">The Http server is just a simple static file server. All the logic is in Wasm in the browser.<br>
The browser uses the root route /. The served files are in the folder /mem2/.<br>
The WebSocket server just broadcasts the received msg to all other connected clients.<br>
TODO: limit communication only between 2 players. Broadcasting is a an overkill. How to get the WS client id on the client?</p>
<p dir="auto">You can play the game here (hosted on google cloud platform):<br>
<a href="https://bestia.dev/mem2" rel="nofollow">https://bestia.dev/mem2</a></p>
<p dir="auto">The frontend Rust Wasm Dodrio Virtual Dom application code is here:<br>
<a href="https://github.com/bestia-dev/mem2">https://github.com/bestia-dev/mem2</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Build and Serve locally</h2><a id="user-content-build-and-serve-locally" class="anchor" aria-label="Permalink: Build and Serve locally" href="#build-and-serve-locally"></a></div>
<p dir="auto">Clone:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="git clone git@github.com:bestia-dev/mem2_server.git  "><pre>git clone git@github.com:bestia-dev/mem2_server.git  </pre></div>
<p dir="auto">Run in mem2_server/ folder</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="cargo run  "><pre>cargo run  </pre></div>
<p dir="auto">The server will print the External IP Address e.g. 192.168.0.22<br>
Open your browser and use that address.<br>
The game is made for exactly 2 players. Open 2 browser windows with the same address.<br>
Preferably on 2 smartphones on the same WiFi network.</p>
<p dir="auto">The frontend files are all in the folder mem2/.<br>
You can replace them eventually with the new version built with wasm-pack from the project <code>mem2</code>.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Memory game rules</h2><a id="user-content-memory-game-rules" class="anchor" aria-label="Permalink: Memory game rules" href="#memory-game-rules"></a></div>
<p dir="auto">This game is for exactly 2 players.<br>
The first player clicks on "Want to play?" and broadcasts the message over WebSocket.<br>
Player2 then sees on the screen a "Accept the game" link, clicks it and sends the message to Player1.<br>
The game starts with a grid of 8 randomly shuffled card pairs face down - 16 cards in all.<br>
On the screen under the grid are clear signals which player plays and which waits.<br>
Player1 flips over two cards with two clicks.<br>
If the cards do not match, the other player clicks on "Take your turn" and both cards are flipped back face down. Then it is his turn and he clicks to flip over his two cards.<br>
If the cards match, they are left face up permanently and the player receives a point. He continues to play, he opens the next two cards.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">The adventure never ends</h2><a id="user-content-the-adventure-never-ends" class="anchor" aria-label="Permalink: The adventure never ends" href="#the-adventure-never-ends"></a></div>
<p dir="auto">There is so much to learn. That is also the goal of this project.<br>
How to use warp for static file server and WebSocket on the same port.<br>
How to route the request to some function (filter).<br>
How to use #cfg to have different codes for Linux and windows.<br>
How to start a command and get the output and parse it with regex.<br>
How to use env_logger to write to the screen and with nanoseconds and colors.<br>
How to parse cmdline parameters with defaults.</p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">cargo crev reviews and advisory</h2><a id="user-content-cargo-crev-reviews-and-advisory" class="anchor" aria-label="Permalink: cargo crev reviews and advisory" href="#cargo-crev-reviews-and-advisory"></a></div>
<p dir="auto">It is recommended to always use <a href="https://github.com/crev-dev/cargo-crev">cargo-crev</a><br>
to verify the trustworthiness of each of your dependencies.<br>
Please, spread this info.<br>
On the web use this url to read crate reviews. Example:<br>
<a href="https://web.crev.dev/rust-reviews/crate/num-traits/" rel="nofollow">https://web.crev.dev/rust-reviews/crate/num-traits/</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">References</h2><a id="user-content-references" class="anchor" aria-label="Permalink: References" href="#references"></a></div>
<p dir="auto"><a href="https://github.com/seanmonstar/warp">https://github.com/seanmonstar/warp</a><br>
<a href="https://docs.rs/env_logger/0.6.0/env_logger/struct.Builder.html" rel="nofollow">https://docs.rs/env_logger/0.6.0/env_logger/struct.Builder.html</a><br>
<a href="https://github.com/tcr/rust-local-ip">https://github.com/tcr/rust-local-ip</a><br>
<a href="https://regex101.com/" rel="nofollow">https://regex101.com/</a><br>
<a href="https://docs.rs/env_logger/*/env_logger/" rel="nofollow">https://docs.rs/env_logger/*/env_logger/</a><br>
<a href="https://docs.rs/regex/1.1.2/regex/struct.Captures.html" rel="nofollow">https://docs.rs/regex/1.1.2/regex/struct.Captures.html</a><br>
<a href="https://doc.rust-lang.org/reference/tokens.html#raw-string-literals" rel="nofollow">https://doc.rust-lang.org/reference/tokens.html#raw-string-literals</a><br>
<a href="https://github.com/clap-rs/clap">https://github.com/clap-rs/clap</a></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto">Open-source and free as a beer</h2><a id="user-content-open-source-and-free-as-a-beer" class="anchor" aria-label="Permalink: Open-source and free as a beer" href="#open-source-and-free-as-a-beer"></a></div>
<p dir="auto">My open-source projects are free as a beer (MIT license).<br>
I just love programming.<br>
But I need also to drink. If you find my projects and tutorials helpful, please buy me a beer by donating to my <a href="https://paypal.me/LucianoBestia" rel="nofollow">PayPal</a>.<br>
You know the price of a beer in your local bar ;-)<br>
So I can drink a free beer for your health :-)<br>
<a href="https://translate.google.com/?hl=en&amp;sl=sl&amp;tl=en&amp;text=Na%20zdravje&amp;op=translate" rel="nofollow">Na zdravje!</a> <a href="https://dictionary.cambridge.org/dictionary/italian-english/alla-salute" rel="nofollow">Alla salute!</a> <a href="https://dictionary.cambridge.org/dictionary/german-english/prost" rel="nofollow">Prost!</a> <a href="https://matadornetwork.com/nights/how-to-say-cheers-in-50-languages/" rel="nofollow">Nazdravlje!</a> üçª</p>
<p dir="auto"><a href="https://bestia.dev" rel="nofollow">//bestia.dev</a><br>
<a href="https://github.com/bestia-dev">//github.com/bestia-dev</a><br>
<a href="https://bestiadev.substack.com" rel="nofollow">//bestiadev.substack.com</a><br>
<a href="https://youtube.com/@bestia-dev-tutorials" rel="nofollow">//youtube.com/@bestia-dev-tutorials</a></p>
</article>
</body>

</html>